{% extends "base.html" %}

{% block title %}Nhập Thiết Bị từ Excel{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title mb-0"><i class="bi bi-upload"></i> Nhập Dữ Liệu Thiết Bị từ Excel</h3>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="file" class="form-label">Chọn file Excel (.xls, .xlsx)</label>
                        <input type="file" id="file" name="file" accept=".xls,.xlsx" class="form-control" required>
                    </div>
                    <div class="d-flex justify-content-end">
                        <a href="{{ url_for('device_list') }}" class="btn btn-secondary me-2">Hủy bỏ</a>
                        <button type="submit" class="btn btn-primary">Bắt đầu nhập</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h5 class="card-title mb-0"><i class="bi bi-info-circle"></i> Hướng dẫn định dạng file Excel</h5>
            </div>
            <div class="card-body">
                <p>File Excel của bạn cần có các cột với tiêu đề chính xác như sau (thêm cột <strong>Giá mua</strong>):</p>
                <p><code>Mã thiết bị, Tên thiết bị, Loại thiết bị, Số serial, Ngày mua, Giá mua, Người mua, Ngày nhập, Tình trạng, Trạng thái, Người quản lý, Ngày cấp phát, Cấu hình, Ghi chú, Người nhập, Thương hiệu, Nhà cung cấp, Bảo hành</code></p>
                <hr>
                <h6>Các giá trị hợp lệ:</h6>
                <ul>
                    <li><strong>Giá mua:</strong> Chỉ nhập số (ví dụ: <code>15000000</code>).</li>
                    <li><strong>Định dạng ngày:</strong> <code>dd-mm-yyyy</code> (ví dụ: 25-08-2025).</li>
                    <li><strong>Tình trạng:</strong> <code>Mới</code>, <code>Sử dụng bình thường</code>, <code>Cần bảo trì</code>, <code>Hỏng</code>.</li>
                    <li><strong>Trạng thái:</strong> <code>Sẵn sàng</code>, <code>Đã cấp phát</code>, <code>Bảo trì</code>.</li>
                    <li><strong>Loại thiết bị:</strong> <code>Laptop</code>, <code>Case máy tính</code>, <code>Server</code>, <code>Ổ điện</code>, <code>Thiết bị điện khác</code>, v.v.</li>
                    <li><strong>Người quản lý:</strong> Phải là "Họ và tên" đầy đủ của một người dùng đã có trong hệ thống.</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}